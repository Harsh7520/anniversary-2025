<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Two Years Anniversary</title>

    <!-- Mapbox GL JS -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --error-color: #d32f2f;
            --text-color: #EAEAEA;
            --subtle-text-color: #B0B0B0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #1c1c1e; /* Dark background for the glass effect to pop */
            color: var(--text-color);
            margin: 0;
            overflow: hidden;
        }

        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            filter: blur(8px);
            transition: filter 0.5s ease-out;
        }

        .main-container.active {
            filter: blur(0);
        }

        #map {
            flex-grow: 1;
            width: 100%;
        }

        /* --- Timeline Bar (Bottom) --- */
        .timeline-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 100;
            padding: 15px 0;
            box-sizing: border-box;
        }

        .timeline-list {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 10px; /* Reduced gap slightly */
            padding: 0 15px; /* Reduced padding slightly */
            list-style: none;
            margin: 0;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            scrollbar-width: none; /* Hide scrollbar for Firefox */
        }

        .timeline-list::-webkit-scrollbar {
            display: none; /* Hide scrollbar for Chrome, Safari, and Opera */
        }

        /* --- Glassmorphism Timeline Event --- */
        .timeline-event {
            flex: 0 0 auto; /* Prevent items from shrinking */
            width: 120px; /* --- MODIFIED: Reduced width to fit more items --- */
            padding: 12px; /* --- MODIFIED: Reduced padding for a more compact look --- */
            cursor: pointer;
            border-radius: 16px;
            scroll-snap-align: start;
            transition: background-color 0.4s, border 0.4s;

            /* Glassmorphism Effect */
            background: rgba(70, 70, 70, 0.3);
            backdrop-filter: blur(12px) saturate(180%);
            -webkit-backdrop-filter: blur(12px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.125);
        }

        .timeline-event:hover {
            background: rgba(90, 90, 90, 0.5);
        }

        .timeline-event.active {
            background: rgba(255, 255, 255, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .timeline-event .date {
            font-weight: 500;
            font-size: 0.75rem; /* Slightly smaller font for date */
            margin-bottom: 4px;
        }

        .timeline-event .title {
            font-size: 0.9rem; /* Slightly smaller font for title */
            color: var(--text-color);
            font-weight: 400;
        }

        /* --- Modal Styling --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 0.5s;
        }

        .modal-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .modal-content {
            background: #2c2c2e;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 400px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-content h2 {
            font-family: 'Playfair Display', serif;
            margin-bottom: 20px;
            color: var(--text-color);
        }
        
        .modal-content select, .modal-content button {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            border-radius: 8px;
            border: 1px solid #444;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            background: #3a3a3c;
            color: var(--text-color);
        }
        
        .modal-content button {
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            border: none;
            transition: background-color 0.3s;
        }
        
        .modal-content button:hover {
            background-color: var(--secondary-color);
        }

        .question { display: none; }
        .question.active { display: block; }
        
        /* --- Incorrect Answer Modal --- */
        .incorrect-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }
        
        .incorrect-modal-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .incorrect-modal-content {
            background: #2c2c2e;
            padding: 40px;
            border-radius: 16px;
            width: 90%;
            max-width: 420px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease-in-out;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .incorrect-modal-overlay.visible .incorrect-modal-content {
             transform: scale(1);
        }

        .incorrect-modal-content h2 {
            font-family: 'Playfair Display', serif;
            color: var(--error-color);
            margin-top: 0;
        }
        
        .incorrect-modal-content p {
             font-size: 1rem;
             line-height: 1.6;
             margin-bottom: 25px;
             color: var(--subtle-text-color);
        }

        .incorrect-modal-content button {
            background-color: var(--error-color);
            color: white;
            cursor: pointer;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .incorrect-modal-content button:hover {
             background-color: #b71c1c;
        }

        /* --- Mapbox Popup Customization --- */
        .mapboxgl-popup {
            max-width: 320px;
            font-family: 'Poppins', sans-serif;
        }

        .mapboxgl-popup-content {
            padding: 0;
            border-radius: 16px;
            /* Applying glassmorphism to popup */
            background: rgba(40, 40, 40, 0.75);
            backdrop-filter: blur(15px) saturate(180%);
            -webkit-backdrop-filter: blur(15px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        
        .popup-image {
            width: 100%;
            height: 180px; /* Reduced image height for a more compact popup */
            object-fit: cover;
            border-top-left-radius: 16px;
            border-top-right-radius: 16px;
        }

        .popup-text {
            padding: 15px 20px;
        }
        
        .popup-text h3 {
             font-family: 'Playfair Display', serif;
             margin: 0 0 5px 0;
             font-size: 1.5rem;
             color: var(--text-color);
        }
        
        .popup-text p {
            margin: 0;
            font-size: 0.95rem;
            line-height: 1.5;
            color: var(--subtle-text-color);
        }

        .mapboxgl-popup-close-button {
            color: var(--text-color);
            font-size: 1.5rem;
            padding: 5px;
        }

    </style>
</head>
<body>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-content">
            <div id="question1" class="question active">
                <h2>What's your favourite date of the year?</h2>
                <select id="date-select">
                    <option value="">Select a date</option>
                    <option value="August 3">August 3rd</option>
                    <option value="August 1">November 8th</option>
                    <option value="August 9">December 25th</option>
                </select>
                <button onclick="checkDate()">Next</button>
            </div>
            <div id="question2" class="question">
                <h2>And who is your favourite person?</h2>
                <select id="person-select">
                    <option value="">Select a person</option>
                    <option value="Person A">Insignificant Person 1</option>
                    <option value="Person B">Insignificant Person 2</option>
                    <option value="Person D">Insignificant Person 3</option>
                    <option value="Correct Answer">Harsh</option>
                </select>
                <button onclick="checkPerson()">Unlock Our Story</button>
            </div>
             <div id="greeting" class="question">
                <h2>🎉 Happy Anniversary Aayushi my love! ❤️</h2>
                <p>Let's have a look back at some of our most precious memories!</p>
            </div>
        </div>
    </div>

    <div class="incorrect-modal-overlay" id="incorrect-modal">
        <div class="incorrect-modal-content">
            <h2>🤔 Wrong Answer</h2>
            <p>It seems this website was intended for someone else. Please kindly hand the QR Code back to its owner.</p>
            <button id="close-incorrect-modal">Try Again</button>
        </div>
    </div>

    <!-- HTML structure changed: Map comes first, then the timeline bar -->
    <div class="main-container" id="main-container">
        <div id="map"></div>
        <div class="timeline-bar">
            <ul class="timeline-list" id="timeline-list">
                <!-- Date items will be inserted here by JavaScript -->
            </ul>
        </div>
    </div>

    <script>
        // --- STEP 1: CUSTOMIZE YOUR MEMORIES HERE ---
        const memories = [
            {
                title: "First Text",
                date: "August 3, 2023",
                description: "Where it all began! I had never been more excited about a notification than that day.",
                coordinates: [72.5606902, 23.0272707],
                image: "first-text.png",
                zoom: 18
            },
            {
                title: "First Date",
                date: "August 9, 2023",
                description: "Our First Meeting! Seeing you in person for the first time was truly magical. I couldn't believe that you were actually real.",
                coordinates: [72.5399, 23.0300], 
                image: "first-date.jpg",
                zoom: 18
            },
            {
                title: "First Kiss",
                date: "August 19, 2023",
                description: "That First Kiss. Absolutely magnetic and we just couldn't stop after that day.",
                coordinates: [72.496107,23.0771561], 
                image: "first-kiss.jpg",
                zoom: 18
            },
            {
                title: "Its Official!",
                date: "October 1, 2023",
                description: "The start of my first relationship! No more just dating or seeing each other, we are now a real couple.",
                coordinates: [72.4431191,23.1263036], 
                image: "first-relationship.jpg",
                zoom: 18
            },
            {
                title: "First Navratri",
                date: "October 20, 2023",
                description: "Our first Navratri together! I was never the type of person to celebrate navratri but you changed me.",
                coordinates: [72.5040826,23.0197201], 
                image: "first-navratri.jpg",
                zoom: 18
            },
            {
                title: "Kankaria",
                date: "November 26, 2023",
                description: "That Kankaria Date. The Train Ride, The Rain, The Photos. Just Perfection.",
                coordinates: [72.601149,23.0061556], 
                image: "kankaria.jpg",
                zoom: 18
            },
            {
                title: "First New Years",
                date: "December 31, 2023",
                description: "Our First New Years together. Excellent food and it felt more like a double date with my parents rather than them taking us somewhere.",
                coordinates: [72.4990401, 23.0907685], 
                image: "first-new-years.jpg",
                zoom: 18
            },
            {
                title: "First Half Anniversary",
                date: "February 3, 2024",
                description: "Our First Half Anniversary. And with the exact same outfits as our first date. We thought we would look different but its basically the same.",
                coordinates: [72.5400857,23.0299867], 
                image: "first-half-anniversary.jpg",
                zoom: 18
            },
            {
                title: "First Time",
                date: "February 10, 2024",
                description: "Our Magical First Time. From building up the courage to buy protection to sneaking you in at night and trying to make you stay calm and feel protected. The most unforgettable night.",
                coordinates: [72.532025, 23.016435], 
                image: "first-time.jpg",
                zoom: 18
            },
            {
                title: "First Valentines",
                date: "February 14, 2024",
                description: "Our First Valentines Day. I never thought I would ever celebrate this day with someone but you changed that quicker than I could say 'Valentines'.",
                coordinates: [72.510025, 23.043703], 
                image: "first-valentines.jpg",
                zoom: 18
            },
            {
                title: "First Vadodra Visit",
                date: "May 17, 2024",
                description: "My first visit to Vadodra and also the first time I have ever travelled alone. I was scared to death but it was worth it for getting to visit you after days of not even seeing each other.",
                coordinates: [73.190583, 22.343995], 
                image: "first-vadodra-visit.jpg",
                zoom: 18
            },
            {
                title: "First Anniversary",
                date: "August 8, 2024",
                description: "Our First Anniversary! That we had to celebrate a few days late... totally not my stomach's fault.",
                coordinates: [72.509834, 23.043802], 
                image: "first-anniversary.jpg",
                zoom: 18
            },
            {
                title: "Second Navratri",
                date: "October 5, 2024",
                description: "Our Second Navratri! This time around we are an experienced couple and even organizing the whole gathering.",
                coordinates: [72.481054, 23.038392], 
                image: "second-navratri.jpg",
                zoom: 18
            },
            {
                title: "Second Vadodra Visit",
                date: "November 30, 2024",
                description: "My Second Vadodra Visit but more importantly, my first sleepover at your home. I really hit it off with chini as well this time.",
                coordinates: [73.190597, 22.343942], 
                image: "second-vadodra-visit.jpg",
                zoom: 18
            },
            {
                title: "Second New Years",
                date: "December 31, 2024",
                description: "Our Second New Years Together! We have now seen 2023, 2024 and 2025 together.",
                coordinates: [72.501215, 23.115359], 
                image: "second-new-years.jpg",
                zoom: 18
            },
            {
                title: "Second Half Anniversary",
                date: "February 3, 2025",
                description: "One and a half years completed. The surprise you gave me that day shocked me so hard I couldn't even believe anything.",
                coordinates: [72.5436161, 23.0283865], 
                image: "second-half-anniversary.jpg",
                zoom: 18
            },
            {
                title: "Second Valentines",
                date: "February 14, 2025",
                description: "Our Second Valentines Day Together! And unexpectedly in Vadodra this time around.",
                coordinates: [73.171609, 22.325102], 
                image: "second-valentines.jpg",
                zoom: 18
            },
            {
                title: "First Holi",
                date: "March 14, 2025",
                description: "Our First Holi Together! we rarely spend holidays together but this time we were able to stick together.",
                coordinates: [72.515982, 23.018453], 
                image: "first-holi.jpg",
                zoom: 18
            },
            {
                title: "First Concert",
                date: "March 29, 2025",
                description: "Our First Concert Together! I never thought I would attend a concert in my life. But attending this one with you was so special.",
                coordinates: [72.599090, 23.010976], 
                image: "first-concert.jpg",
                zoom: 18
            },
            {
                title: "Law Garden",
                date: "2023-2023",
                description: "Our old hangout spot back when you were at your old PG. Also the location of my first hug!",
                coordinates: [72.560817, 23.026436], 
                image: "law-garden.jpg",
                zoom: 18
            },
            {
                title: "Riverfront",
                date: "2023-Present",
                description: "Ahh Riverfront. Very far away but always worth the drive.",
                coordinates: [72.572350, 23.033539], 
                image: "riverfront.jpg",
                zoom: 18
            },
            {
                title: "Symphony",
                date: "2023-Present",
                description: "Symphony. The place where we have spent more time in the parking than in the actual garden",
                coordinates: [72.511548, 23.044953], 
                image: "symphony.jpg",
                zoom: 18
            },
            {
                title: "Papa's Home 10 PG",
                date: "2023-Present",
                description: "Your current and hopefully final PG. The place where we have spent the most time together and also the place where you would be reading this while we exchange our gifts.",
                coordinates: [72.511149, 23.040578], 
                image: "papas-home.jpg",
                zoom: 18
            }
        ];

        const incorrectModal = document.getElementById('incorrect-modal');
        const closeIncorrectModalBtn = document.getElementById('close-incorrect-modal');

        function showIncorrectModal() {
            incorrectModal.classList.add('visible');
        }

        function hideIncorrectModal() {
            incorrectModal.classList.remove('visible');
        }

        closeIncorrectModalBtn.addEventListener('click', hideIncorrectModal);

        function checkDate() {
            const selectedDate = document.getElementById('date-select').value;
            if (selectedDate === 'August 3') {
                document.getElementById('question1').classList.remove('active');
                document.getElementById('question2').classList.add('active');
            } else {
                showIncorrectModal();
            }
        }

        function checkPerson() {
            const selectedPerson = document.getElementById('person-select').value;
            if (selectedPerson === 'Correct Answer') {
                document.getElementById('question2').classList.remove('active');
                document.getElementById('greeting').classList.add('active');

                setTimeout(() => {
                    document.getElementById('modal-overlay').classList.add('hidden');
                    document.getElementById('main-container').classList.add('active');
                    initializeMap();
                }, 4000); // Shorter delay for greeting
            } else {
                showIncorrectModal();
            }
        }

        function initializeMap() {
            mapboxgl.accessToken = 'pk.eyJ1IjoiaGFyc2g3NTIiLCJhIjoiY21kYjl3ZzhoMDRxZTJrc2E5M244cmZiMSJ9.EjmLpn3SsneGjPonisifxg';

            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/navigation-night-v1?optimize=true',
                projection: 'globe',
                zoom: 2,
                center: [72.5, 23.0],
                pitch: 45,
                coalesceMoveEvents: true,
            });

            map.on('style.load', () => {
                map.setConfigProperty('basemap', 'lightPreset', 'night');
            });

            const timelineList = document.getElementById('timeline-list');
            const popups = [];

            memories.forEach((memory, index) => {
                const popupContent = `
                    <div class="popup-container">
                        <img src="${memory.image}" alt="${memory.title}" class="popup-image">
                        <div class="popup-text">
                            <h3>${memory.title}</h3>
                            <p>${memory.description}</p>
                        </div>
                    </div>
                `;
                
                // --- MODIFIED: Added anchor: 'bottom' to encourage opening upwards ---
                const popup = new mapboxgl.Popup({ 
                    closeOnClick: true, 
                    offset: 25, 
                    className: 'glass-popup',
                    anchor: 'bottom' 
                }).setHTML(popupContent);
                
                popups.push(popup);

                new mapboxgl.Marker({ color: 'var(--primary-color)' })
                    .setLngLat(memory.coordinates)
                    .setPopup(popup)
                    .addTo(map);

                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <div class="timeline-event" data-index="${index}">
                        <div class="date">${memory.date}</div>
                        <div class="title">${memory.title}</div>
                    </div>
                `;
                timelineList.appendChild(listItem);
            });

            timelineList.addEventListener('click', (e) => {
                const eventElement = e.target.closest('.timeline-event');
                if (eventElement) {
                    const index = eventElement.getAttribute('data-index');
                    const memory = memories[index];

                    map.flyTo({
                        center: memory.coordinates,
                        zoom: memory.zoom || 18, // Use defined zoom or a default
                        speed: 1.0,
                        curve: 1.2,
                        essential: true
                    });

                    map.once('moveend', () => {
                        popups.forEach(p => p.remove()); // Close all other popups
                        popups[index].setLngLat(memory.coordinates).addTo(map);
                    });

                    document.querySelectorAll('.timeline-event').forEach(el => el.classList.remove('active'));
                    eventElement.classList.add('active');

                    // Horizontally center the active element in the list
                    eventElement.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                }
            });
            
            map.on('load', () => {
                // Highlight the first item on load
                const firstEvent = document.querySelector('.timeline-event');
                if (firstEvent) {
                    firstEvent.classList.add('active');
                }
            });
        }
    </script>
</body>
</html>
