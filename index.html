<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Two Years Anniversary</title>

    <!-- Mapbox GL JS -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --error-color: #d32f2f;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            overflow: hidden; /* Prevents scrolling the whole page */
        }

        .main-container {
            display: flex;
            flex-direction: column; /* Mobile first */
            height: 100vh;
            filter: blur(8px); /* Initially blurred */
            transition: filter 0.5s ease-out;
        }

        .main-container.active {
            filter: blur(0);
        }

        /* --- Modal Styling --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 0.5s;
        }

        .modal-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        .modal-content h2 {
            font-family: 'Playfair Display', serif;
            margin-bottom: 20px;
        }
        
        .modal-content select, .modal-content button {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
        }
        
        .modal-content button {
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            border: none;
            transition: background-color 0.3s;
        }
        
        .modal-content button:hover {
            background-color: var(--secondary-color);
        }

        .question {
            display: none;
        }

        .question.active {
            display: block;
        }
        
        .incorrect-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001; /* Higher z-index to appear on top */
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }
        
        .incorrect-modal-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .incorrect-modal-content {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.25);
            width: 90%;
            max-width: 420px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s ease-in-out;
        }
        
        .incorrect-modal-overlay.visible .incorrect-modal-content {
             transform: scale(1);
        }

        .incorrect-modal-content h2 {
            font-family: 'Playfair Display', serif;
            color: var(--error-color);
            margin-top: 0;
        }
        
        .incorrect-modal-content p {
             font-size: 1rem;
             line-height: 1.6;
             margin-bottom: 25px;
        }

        .incorrect-modal-content button {
            background-color: var(--error-color);
            color: white;
            cursor: pointer;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .incorrect-modal-content button:hover {
             background-color: #b71c1c;
        }

        /* --- Timeline Styling --- */
        .timeline-bar {
            background: #fff;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-y: auto;
            border-bottom: 1px solid #ddd;
        }
        
        .timeline-bar h2 {
            font-family: 'Playfair Display', serif;
            text-align: center;
            margin: 0 0 20px 0;
            font-size: 1.8rem;
        }

        .timeline-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .timeline-event {
            padding: 15px;
            cursor: pointer;
            border-left: 4px solid transparent;
            transition: background-color 0.3s, border-left 0.3s;
        }
        
        .timeline-event:hover {
            background-color: #f0f0f0;
        }

        .timeline-event.active {
            border-left: 4px solid var(--primary-color);
            background-color: #e8eaf6;
        }

        .timeline-event .date {
            font-weight: bold;
            font-size: 0.9rem;
            color: var(--primary-color);
        }

        .timeline-event .title {
            font-size: 1.1rem;
        }

        /* --- Map Styling --- */
        #map {
            flex-grow: 1; /* Takes up remaining space */
            width: 100%;
        }

        /* --- Mapbox Popup Customization --- */
        .mapboxgl-popup {
            max-width: 320px;
            font-family: 'Poppins', sans-serif;
        }

        .mapboxgl-popup-content {
            padding: 0;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .popup-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

        .popup-text {
            padding: 15px 20px;
        }
        
        .popup-text h3 {
             font-family: 'Playfair Display', serif;
             margin: 0 0 5px 0;
             font-size: 1.5rem;
        }
        
        .popup-text p {
            margin: 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* --- Desktop Layout --- */
        @media (min-width: 768px) {
            .main-container {
                flex-direction: row;
            }

            .timeline-bar {
                width: 350px;
                height: 100vh;
                border-right: 1px solid #ddd;
                border-bottom: none;
            }
        }
    </style>
</head>
<body>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-content">
            <div id="question1" class="question active">
                <h2>What's your favourite date of the year?</h2>
                <select id="date-select">
                    <option value="">Select a date</option>
                    <option value="August 3">August 3rd</option>
                    <option value="August 1">November 8th</option>
                    <option value="August 9">December 25th</option>
                </select>
                <button onclick="checkDate()">Next</button>
            </div>
            <div id="question2" class="question">
                <h2>And who is your favourite person?</h2>
                <select id="person-select">
                    <option value="">Select a person</option>
                    <option value="Person A">Insignificant Person 1</option>
                    <option value="Person B">Insignificant Person 2</option>
                    <option value="Person D">Insignificant Person 3</option>
                    <option value="Correct Answer">Harsh</option>
                </select>
                <button onclick="checkPerson()">Unlock Our Story</button>
            </div>
             <div id="greeting" class="question">
                <h2>üéâ Happy Anniversary Aayushi my love! ‚ù§Ô∏è</h2>
                <p>Let's have a look back at some of our most precious memories!</p>
            </div>
        </div>
    </div>

    <div class="incorrect-modal-overlay" id="incorrect-modal">
        <div class="incorrect-modal-content">
            <h2>ü§î Wrong Answer</h2>
            <p>It seems this website was intended for someone else. Please kindly hand the QR Code back to its owner.</p>
            <button id="close-incorrect-modal">Try Again</button>
        </div>
    </div>

    <div class="main-container" id="main-container">
        <div class="timeline-bar">
            <h2>Our Story</h2>
            <ul class="timeline-list" id="timeline-list">
                <!-- Date items will be inserted here -->
            </ul>
        </div>
        <div id="map"></div>
    </div>

    <script>
        // --- STEP 1: CUSTOMIZE YOUR MEMORIES HERE ---
        const memories = [
            {
                title: "First Text",
                date: "August 3, 2023",
                description: "Where it all began! I had never been more excited about a notification than that day.",
                coordinates: [72.5606902, 23.0272707],
                image: "first-text.png",
                zoom: 20
            },
            {
                title: "First Date",
                date: "August 9, 2023",
                description: "Our First Meeting! Seeing you in person for the first time was truly magical. I couldn't believe that you were actually real.",
                coordinates: [72.5399, 23.0300], 
                image: "first-date.jpg",
                zoom: 20
            },
            {
                title: "First Kiss",
                date: "August 19, 2023",
                description: "That First Kiss. Absolutely magnetic and we just couldn't stop after that day.",
                coordinates: [72.496107,23.0771561], 
                image: "first-kiss.jpg",
                zoom: 20
            },
            {
                title: "Its Official!",
                date: "October 1, 2023",
                description: "The start of my first relationship! No more just dating or seeing each other, we are now a real couple.",
                coordinates: [72.4431191,23.1263036], 
                image: "first-relationship.jpg",
                zoom: 20
            },
            {
                title: "First Navratri",
                date: "October 20, 2023",
                description: "Our first Navratri together! I was never the type of person to celebrate navratri but you changed me.",
                coordinates: [72.5040826,23.0197201], 
                image: "first-navratri.jpg",
                zoom: 20
            },
            {
                title: "Kankaria",
                date: "November 26, 2023",
                description: "That Kankaria Date. The Train Ride, The Rain, The Photos. Just Perfection.",
                coordinates: [72.601149,23.0061556], 
                image: "kankaria.jpg",
                zoom: 20
            },
            {
                title: "First New Years",
                date: "December 31, 2023",
                description: "Our First New Years together. Excellent food and it felt more like a double date with my parents rather than them taking us somewhere.",
                coordinates: [72.4990401, 23.0907685], 
                image: "first-new-years.jpg",
                zoom: 20
            },
            {
                title: "First Half Anniversary",
                date: "February 3, 2024",
                description: "Our First Half Anniversary. And with the exact same outfits as our first date. We thought we would look different but its basically the same.",
                coordinates: [72.5400857,23.0299867], 
                image: "first-half-anniversary.jpg",
                zoom: 20
            },
            {
                title: "First Time",
                date: "February 10, 2024",
                description: "Our Magical First Time. From building up the courage to buy protection to sneaking you in at night and trying to make you stay calm and feel protected. The most unforgettable night.",
                coordinates: [72.532025, 23.016435], 
                image: "first-time.jpg",
                zoom: 20
            },
            {
                title: "First Valentines",
                date: "February 14, 2024",
                description: "Our First Valentines Day. I never thought I would ever celebrate this day with someone but you changed that quicker than I could say 'Valentines'.",
                coordinates: [72.510025, 23.043703], 
                image: "first-valentines.jpg",
                zoom: 20
            },
            {
                title: "First Vadodra Visit",
                date: "May 17, 2024",
                description: "My first visit to Vadodra and also the first time I have ever travelled alone. I was scared to death but it was worth it for getting to visit you after days of not even seeing each other.",
                coordinates: [73.190583, 22.343995], 
                image: "first-vadodra-visit.jpg",
                zoom: 20
            },
            {
                title: "First Anniversary",
                date: "August 8, 2024",
                description: "Our First Anniversary! That we had to celebrate a few days late... totally not my stomach's fault.",
                coordinates: [72.509834, 23.043802], 
                image: "first-anniversary.jpg",
                zoom: 20
            },
            {
                title: "Second Navratri",
                date: "October 5, 2024",
                description: "Our Second Navratri! This time around we are an experienced couple and even organizing the whole gathering.",
                coordinates: [72.481054, 23.038392], 
                image: "second-navratri.jpg",
                zoom: 20
            },
            {
                title: "Second Vadodra Visit",
                date: "November 30, 2024",
                description: "My Second Vadodra Visit but more importantly, my first sleepover at your home. I really hit it off with chini as well this time.",
                coordinates: [73.190597, 22.343942], 
                image: "second-vadodra-visit.jpg",
                zoom: 20
            },
            {
                title: "Second New Years",
                date: "December 31, 2024",
                description: "Our Second New Years Together! We have now seen 2023, 2024 and 2025 together.",
                coordinates: [72.501215, 23.115359], 
                image: "second-new-years.jpg",
                zoom: 20
            },
            {
                title: "Second Half Anniversary",
                date: "February 3, 2025",
                description: "One and a half years completed. The surprise you gave me that day shocked me so hard I couldn't even believe anything.",
                coordinates: [72.5436161, 23.0283865], 
                image: "second-half-anniversary.jpg",
                zoom: 20
            },
            {
                title: "Second Valentines",
                date: "February 14, 2025",
                description: "Our Second Valentines Day Together! And unexpectedly in Vadodra this time around.",
                coordinates: [73.171609, 22.325102], 
                image: "second-valentines.jpg",
                zoom: 20
            },
            {
                title: "First Holi",
                date: "March 14, 2025",
                description: "Our First Holi Together! we rarely spend holidays together but this time we were able to stick together.",
                coordinates: [72.515982, 23.018453], 
                image: "first-holi.jpg",
                zoom: 20
            },
            {
                title: "First Concert",
                date: "March 29, 2025",
                description: "Our First Concert Together! I never thought I would attend a concert in my life. But attending this one with you was so special.",
                coordinates: [72.599090, 23.010976], 
                image: "first-concert.jpg",
                zoom: 20
            },
            {
                title: "Law Garden",
                date: "2023-2023",
                description: "Our old hangout spot back when you were at your old PG. Also the location of my first hug!",
                coordinates: [72.572350, 23.033539], 
                image: "law-garden.jpg",
                zoom: 20
            },
            {
                title: "Riverfront",
                date: "2023-Present",
                description: "Ahh Riverfront. Very far away but always worth the drive.",
                coordinates: [72.572350, 23.033539], 
                image: "riverfront.jpg",
                zoom: 20
            },
            {
                title: "Symphony",
                date: "2023-Present",
                description: "Symphony. The place where we have spent more time in the parking than in the actual garden",
                coordinates: [72.511548, 23.044953], 
                image: "symphony.jpg",
                zoom: 20
            },
            {
                title: "Papa's Home 10 PG",
                date: "2023-Present",
                description: "Your current and hopefully final PG. The place where we have spent the most time together and also the place where you would be reading this while we exchange our gifts.",
                coordinates: [72.511149, 23.040578], 
                image: "papas-home.jpg",
                zoom: 20
            }
        ];

        const incorrectModal = document.getElementById('incorrect-modal');
        const closeIncorrectModalBtn = document.getElementById('close-incorrect-modal');

        function showIncorrectModal() {
            incorrectModal.classList.add('visible');
        }

        function hideIncorrectModal() {
            incorrectModal.classList.remove('visible');
        }

        closeIncorrectModalBtn.addEventListener('click', hideIncorrectModal);

        // --- Modal Logic ---
        function checkDate() {
            const selectedDate = document.getElementById('date-select').value;
            if (selectedDate === 'August 3') {
                document.getElementById('question1').classList.remove('active');
                document.getElementById('question2').classList.add('active');
            } else {
                showIncorrectModal();
            }
        }


        function checkPerson() {
            const selectedPerson = document.getElementById('person-select').value;
            if (selectedPerson === 'Correct Answer') {
                document.getElementById('question2').classList.remove('active');
                document.getElementById('greeting').classList.add('active');

                setTimeout(() => {
                    document.getElementById('modal-overlay').classList.add('hidden');
                    document.getElementById('main-container').classList.add('active');
                    initializeMap();
                }, 6000); // Show greeting for 2 seconds
            } else {
                showIncorrectModal();
            }
        }


        function initializeMap() {
            mapboxgl.accessToken = 'pk.eyJ1IjoiaGFyc2g3NTIiLCJhIjoiY21kYjl3ZzhoMDRxZTJrc2E5M244cmZiMSJ9.EjmLpn3SsneGjPonisifxg';

            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/outdoors-v12?optimize=true',
                projection: 'globe',
                zoom: 2,
                center: [72.5, 23.0],
                pitch: 60,
                coalesceMoveEvents: true,
            });


            map.on('style.load', () => {
                map.setConfigProperty('basemap', 'lightPreset', 'night');
            });

            const timelineList = document.getElementById('timeline-list');
            const popups = [];

            memories.forEach((memory, index) => {
                const popupContent = `
                    <div>
                        <img src="${memory.image}" alt="${memory.title}" class="popup-image">
                        <div class="popup-text">
                            <h3>${memory.title}</h3>
                            <p>${memory.description}</p>
                        </div>
                    </div>
                `;
                
                const popup = new mapboxgl.Popup({ closeOnClick: true, offset: 25 }).setHTML(popupContent);
                popups.push(popup);

                new mapboxgl.Marker({ color: 'var(--primary-color)' })
                    .setLngLat(memory.coordinates)
                    .setPopup(popup)
                    .addTo(map);

                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <div class="timeline-event" data-index="${index}">
                        <div class="date">${memory.date}</div>
                        <div class="title">${memory.title}</div>
                    </div>
                `;
                timelineList.appendChild(listItem);
            });

            timelineList.addEventListener('click', (e) => {
                const eventElement = e.target.closest('.timeline-event');
                if (eventElement) {
                    const index = eventElement.getAttribute('data-index');
                    const memory = memories[index];

                    function easing(t) {
                        return t * (2 - t);
                    }


                    map.flyTo({
                        center: memory.coordinates,
                        zoom: memory.zoom,
                        speed: 0.8,
                        curve: 1.4,
                        easing: easing,
                        essential: true
                    });


                    map.once('moveend', () => {
                        popups[index].setLngLat(memory.coordinates).addTo(map);
                    });

                    document.querySelectorAll('.timeline-event').forEach(el => el.classList.remove('active'));
                    eventElement.classList.add('active');
                }
            });
            
            map.on('load', () => {
                // Highlight first item on load
                 document.querySelector('.timeline-event').classList.add('active');
            });
        }
    </script>
</body>
</html>